<!-- Sidebar Collapsible JavaScript -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Sidebar toggle functionality
    const sidebarToggle = document.getElementById('sidebar-toggle');
    const sidebarWrapper = document.getElementById('sidebar-wrapper');
    const body = document.body;
    
    if (sidebarToggle && sidebarWrapper) {
      // Check if sidebar should be closed by default on mobile
      if (window.innerWidth < 900) {
        body.classList.add('sidebar-closed');
      }
      
      // Toggle sidebar on button click
      sidebarToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        body.classList.toggle('sidebar-closed');
      });
      
      // Close sidebar when clicking outside on mobile
      document.addEventListener('click', function(e) {
        if (window.innerWidth < 900 && 
            !body.classList.contains('sidebar-closed') && 
            !sidebarWrapper.contains(e.target) && 
            e.target !== sidebarToggle) {
          body.classList.add('sidebar-closed');
        }
      });
      
      // Handle window resize
      window.addEventListener('resize', function() {
        if (window.innerWidth < 900) {
          if (!body.classList.contains('sidebar-closed-manually')) {
            body.classList.add('sidebar-closed');
          }
        } else {
          body.classList.remove('sidebar-closed');
        }
      });
      
      // Track if user manually closed the sidebar
      sidebarToggle.addEventListener('click', function() {
        if (body.classList.contains('sidebar-closed')) {
          body.classList.add('sidebar-closed-manually');
        } else {
          body.classList.remove('sidebar-closed-manually');
        }
      });
      
      // Prevent closing when clicking inside sidebar
      sidebarWrapper.addEventListener('click', function(e) {
        e.stopPropagation();
      });
    }
    
    // Get all collapse buttons
    const collapseButtons = document.querySelectorAll('.collapse-btn');
    
    // Add click event to each button
    collapseButtons.forEach(function(button) {
      button.addEventListener('click', function(e) {
        e.stopPropagation();
        // Toggle aria-expanded attribute
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        button.setAttribute('aria-expanded', !isExpanded);
        
        // Find the nearest tree-children element (sibling)
        const treeFolder = button.closest('.tree-folder');
        const treeChildren = treeFolder.nextElementSibling;
        
        if (treeChildren && treeChildren.classList.contains('tree-children')) {
          // Toggle the collapsed class
          treeChildren.classList.toggle('collapsed');
        }
      });
    });
  });
</script>

{{ with resources.Get "js/main.js" }}
  {{ if eq hugo.Environment "development" }}
    <script src="{{ .RelPermalink }}"></script>
  {{ else }}
    {{ with . | minify | fingerprint }}
      <script src="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous"></script>
    {{ end }}
  {{ end }}
{{ end }}
